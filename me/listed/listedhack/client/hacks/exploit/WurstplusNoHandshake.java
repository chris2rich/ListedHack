package me.listed.listedhack.client.hacks.exploit;

import io.netty.buffer.Unpooled;
import java.util.function.Predicate;
import me.listed.listedhack.client.event.events.WurstplusEventPacket;
import me.listed.listedhack.client.hacks.WurstplusCategory;
import me.listed.listedhack.client.hacks.WurstplusHack;
import me.zero.alpine.fork.listener.EventHandler;
import me.zero.alpine.fork.listener.Listener;
import net.minecraft.network.PacketBuffer;
import net.minecraft.network.play.client.CPacketCustomPayload;
import net.minecraftforge.fml.common.network.internal.FMLProxyPacket;

public class WurstplusNoHandshake extends WurstplusHack {
   @EventHandler
   private Listener<WurstplusEventPacket.SendPacket> send_listener = new Listener((event) -> {
      if (event.get_packet() instanceof FMLProxyPacket && !mc.func_71356_B()) {
         event.cancel();
      }

      if (event.get_packet() instanceof CPacketCustomPayload) {
         CPacketCustomPayload packet = (CPacketCustomPayload)event.get_packet();
         if (packet.func_149559_c().equalsIgnoreCase("MC|Brand")) {
            packet.field_149561_c = (new PacketBuffer(Unpooled.buffer())).func_180714_a("vanilla");
         }
      }

   }, new Predicate[0]);

   public WurstplusNoHandshake() {
      super(WurstplusCategory.WURSTPLUS_EXPLOIT);
      this.name = "No Handshake";
      this.tag = "NoHandshake";
      this.description = "im more of a high-5 guy";
   }
}
